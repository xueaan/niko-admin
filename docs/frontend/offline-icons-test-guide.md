# 离线图标和彩色图标功能测试指南

## 功能概述

本次实现了以下功能：
1. **离线图标支持** - 图标选择器支持在线/离线/自动三种模式
2. **彩色图标功能** - 菜单图标可根据功能类型自动显示不同颜色
3. **用户偏好设置** - 在偏好设置中可开关彩色图标功能

## 测试步骤

### 1. 测试离线图标功能

#### 1.1 图标选择器模式切换

1. 打开任意包含图标选择器的页面（如菜单管理）
2. 点击图标选择器，应看到顶部有三个模式选项：
   - **在线模式** - 从 Iconify API 获取图标
   - **离线模式** - 仅使用预注册的离线图标
   - **自动** - 优先使用离线图标，无离线图标时回退到在线

3. 切换到**离线模式**，应看到右侧显示"离线图标: 112个"
4. 在离线模式下搜索图标，只会显示预注册的离线图标
5. 模式选择会自动保存到 localStorage，刷新页面后保持

#### 1.2 验证离线图标集合

已注册的离线图标包括：
- 系统管理类：`eos-icons:system-group`, `ant-design:setting-outlined`
- 用户相关类：`ant-design:user-outlined`, `ph:user-duotone`
- 监控类：`solar:monitor-bold-duotone`
- 工具类：`ant-design:tool-outlined`, `mdi:tools`
- 开发相关：`devicon:redis-wordmark`, `logos:vue`
- 等共计 112 个常用图标

### 2. 测试彩色图标功能

#### 2.1 开启彩色图标

1. 点击右侧的**偏好设置**按钮（齿轮图标）
2. 切换到**布局**标签页
3. 找到**导航菜单**部分
4. 开启**彩色图标**开关
5. 提示文字：开启后，菜单图标将根据功能类型显示不同的颜色

#### 2.2 验证彩色效果

开启彩色图标后，菜单图标会自动显示不同颜色：
- **系统管理类**（含 system/setting）：蓝色 `text-blue-500`
- **用户相关**（含 user/role）：绿色 `text-green-500`
- **监控报表**（含 monitor）：橙色 `text-orange-500`
- **工具设置**（含 tool）：紫色 `text-purple-500`
- **部门字典**（含 department/dict）：靛蓝色 `text-indigo-500`
- **通知消息**（含 notice/message）：黄色 `text-yellow-500`
- **日志登录**（含 log/login）：灰色 `text-gray-500`
- **流程工作流**（含 flow/workflow）：青色 `text-cyan-500`
- **其他图标**：默认灰色 `text-gray-600`

### 3. 内网环境部署测试

#### 3.1 模拟离线环境

1. 打开浏览器开发者工具（F12）
2. 切换到 Network 标签
3. 设置为 Offline 模式
4. 刷新页面

#### 3.2 验证离线功能

在离线环境下：
1. 图标选择器切换到**离线模式**，应正常显示所有离线图标
2. 菜单图标应正常显示（已预加载的离线图标）
3. 彩色图标功能应正常工作

### 4. 性能测试

#### 4.1 加载速度对比

- **在线模式**：需要请求 Iconify API，有网络延迟
- **离线模式**：立即显示，无网络请求
- **自动模式**：离线图标立即显示，其他图标有延迟

#### 4.2 内存占用

离线图标已通过 Tree Shaking 优化，只打包实际使用的图标，不会明显增加包体积。

## 配置说明

### 离线图标配置

离线图标集合定义在：
```
niko-ui/packages/icons/src/iconify-offline/offline-collection.ts
```

如需添加新的离线图标：
1. 在 `OFFLINE_ICONS` 数组中添加图标名称
2. 在 `menu-icons.ts` 中导入并注册对应图标

### 彩色图标配置

彩色规则定义在：
```
niko-ui/packages/@core/ui-kit/menu-ui/src/components/menu-item.vue
```

如需修改颜色映射规则，编辑 `iconColorClass` 计算属性。

## 常见问题

### Q: 离线模式下找不到需要的图标？
A: 需要在 `offline-collection.ts` 中添加图标，并在 `menu-icons.ts` 中注册。

### Q: 彩色图标不生效？
A: 检查：
1. 是否在偏好设置中开启了彩色图标
2. 图标名称是否匹配颜色规则
3. 是否有其他 CSS 覆盖了颜色

### Q: 如何为特定菜单设置自定义颜色？
A: 在路由配置的 meta 中添加 `iconColor` 属性：
```typescript
{
  meta: {
    title: '特殊功能',
    icon: 'custom-icon',
    iconColor: 'text-pink-500'
  }
}
```

## 总结

通过本次实现，niko-admin 现在支持：
1. ✅ 离线图标 - 适合内网部署，无需外网访问
2. ✅ 图标模式切换 - 灵活适应不同网络环境
3. ✅ 彩色图标 - 提升界面美观度和功能区分度
4. ✅ 用户偏好 - 可根据喜好开关彩色图标

所有功能都已集成到现有系统中，无需额外配置即可使用。